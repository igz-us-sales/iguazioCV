kind: job
metadata:
  name: create-api-gateway
  tag: ''
  hash: fe90e75874634890fa2bcc624c51ceaa36dbccb7
  project: facial-recognition-demo
spec:
  command: ''
  args: []
  env:
  - name: API_GATEWAY
    value: camera-img
  - name: PROJECT
    value: facial-recognition-demo
  - name: GET_IMAGE_FUNCTION
    value: latest-image-retrieve
  - name: V3IO_USERNAME
    value: ''
  - name: IGZ_AUTH
    value: IL!keD@t@123
  - name: IGZ_NAMESPACE_DOMAIN
    value: default-tenant.app.nicks-dev-cluster.iguazio-cd2.com
  - name: TAGGED_VIDEO_STREAM
    value: taggedvideos
  default_handler: handler
  entry_points:
    handler:
      name: handler
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: event
        default: ''
      outputs:
      - default: ''
      lineno: 60
  description: ''
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IHVybGxpYjMKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBqc29uCmltcG9ydCB0aW1lCmltcG9ydCBvcwoKdXJsbGliMy5kaXNhYmxlX3dhcm5pbmdzKHVybGxpYjMuZXhjZXB0aW9ucy5JbnNlY3VyZVJlcXVlc3RXYXJuaW5nKQoKQVBJX0dBVEVXQVlfTkFNRSA9IGYie29zLmdldGVudignQVBJX0dBVEVXQVknKX0te29zLmdldGVudignUFJPSkVDVCcpfSIKQVBJX0dBVEVXQVlfSE9TVCA9IGYie0FQSV9HQVRFV0FZX05BTUV9Lntvcy5nZXRlbnYoJ0lHWl9OQU1FU1BBQ0VfRE9NQUlOJyl9IgpBUElfRlVOQ1RJT04gPSBmIntvcy5nZXRlbnYoJ1BST0pFQ1QnKX0te29zLmdldGVudignR0VUX0lNQUdFX0ZVTkNUSU9OJyl9IgpEQVNIQk9BUkRfVVJMID0gZiJodHRwczovL2Rhc2hib2FyZC57b3MuZ2V0ZW52KCdJR1pfTkFNRVNQQUNFX0RPTUFJTicpfSIKCnNlc3Npb24gPSByZXF1ZXN0cy5TZXNzaW9uKCkKc2Vzc2lvbi5hdXRoID0gKG9zLmdldGVudigiVjNJT19VU0VSTkFNRSIpLCBvcy5nZXRlbnYoIklHWl9BVVRIIikpCmF1dGggPSBzZXNzaW9uLnBvc3QoZid7REFTSEJPQVJEX1VSTH0vYXBpL3Nlc3Npb25zJywgdmVyaWZ5PUZhbHNlKQoKc2Vzc2lvbl9pZCA9IGF1dGguanNvbigpWydkYXRhJ11bJ2lkJ10KcHJpbnQoZidTZXNzaW9uIG9wZW5lZCwgeW91ciBzZXNzaW9uIElEIGlzOiB7c2Vzc2lvbl9pZH0nKQoKcmVxdWVzdCA9IHsKICAgJ2RhdGEnOnsKICAgICAgJ2F0dHJpYnV0ZXMnOnsKICAgICAgICAgJ21ldGEnOnsKICAgICAgICAgICAgJ25hbWUnOiBvcy5nZXRlbnYoIkFQSV9HQVRFV0FZIiksCiAgICAgICAgICAgICAibGFiZWxzIjogewogICAgICAgICAgICAgICAgImVudHJpZXMiOiBbCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBvcy5nZXRlbnYoIlYzSU9fVVNFUk5BTUUiKSwKICAgICAgICAgICAgICAgICAgICAia2V5IjogImlndWF6aW8uY29tL3VzZXJuYW1lIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogb3MuZ2V0ZW52KCJQUk9KRUNUIiksCiAgICAgICAgICAgICAgICAgICAgImtleSI6ICJwcm9qZWN0LW5hbWUiCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfSwKICAgICAgICAgfSwKICAgICAgICAgJ3NwZWMnOnsKICAgICAgICAgICAgJ2F1dGhlbnRpY2F0aW9uX21vZGUnOidub25lJywKICAgICAgICAgICAgJ2hvc3QnOiBBUElfR0FURVdBWV9IT1NULAogICAgICAgICAgICAndXBzdHJlYW1zJzpbCiAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgJ2tpbmQnOidudWNsaW9mdW5jdGlvbicsCiAgICAgICAgICAgICAgICAgICdudWNsaW9mdW5jdGlvbic6ewogICAgICAgICAgICAgICAgICAgICAnbmFtZSc6IEFQSV9GVU5DVElPTiwKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgICAgICAnZGVzY3JpcHRpb24nOmYnR2V0IGltYWdlIGZyb20gIntvcy5nZXRlbnYoIlRBR0dFRF9WSURFT19TVFJFQU0iKX0iJywKICAgICAgICAgICAgJ25hbWUnOiBvcy5nZXRlbnYoIkFQSV9HQVRFV0FZIiksCiAgICAgICAgIH0sCiAgICAgIH0sCiAgICAgICd0eXBlJzonYXBpX2dhdGV3YXknCiAgIH0sCn0KCmRlZiBoYW5kbGVyKGNvbnRleHQsIGV2ZW50KToKICAgIHJlc3BvbnNlID0gc2Vzc2lvbi5wb3N0KGYne0RBU0hCT0FSRF9VUkx9L2FwaS9hcGlfZ2F0ZXdheXMnLCBqc29uPXJlcXVlc3QsIGhlYWRlcnM9eyd4LWlnei1wcm9qZWN0LW5hbWUnOiBvcy5nZXRlbnYoIlBST0pFQ1QiKX0pCiAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSA0MDk6CiAgICAgICAgcHJpbnQoZidBUEkgR2F0ZXdheSB3aXRoIG5hbWUge0FQSV9HQVRFV0FZX05BTUV9IGFscmVhZHkgZXhpc3RzIChUaGF0XCdzIE9LISknKQogICAgZWxzZToKICAgICAgICBwcmludChqc29uLmR1bXBzKHJlc3BvbnNlLmpzb24oKSwgaW5kZW50PTIpKQoKICAgIHByaW50KCdEb25lIGNyZWF0aW5nIEFQSSBnYXRld2F5IScpCgo=
    image: docker-registry.default-tenant.app.nicks-dev-cluster.iguazio-cd2.com:80/facial-recognition-demo-image
    commands: []
    code_origin: https://github.com/nschenone/iguazioCV.git#19f5b38e8e66387d75dcfcbd50a7a19c2271419e:create-api-gateway.ipynb
